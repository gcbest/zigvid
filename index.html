<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Ziggeo Test Video Page</title>
	<link rel="stylesheet" href="https://assets-cdn.ziggeo.com/v1-stable/ziggeo.css" />
	<script src="https://assets-cdn.ziggeo.com/v1-stable/ziggeo.js"></script>

	<script>ZiggeoApi.token = "35ddfcdb61cb69101828fe7ef30dd230";</script>
	<script>ZiggeoApi.Config.webrtc = true;</script> 
	
	
	<script>

    if ("WebSocket" in window) {
      alert("websocket is there");
    }

    var token = "PkgYqamxF%2FMT9NFK62FXLhqBLJo2rXTZIpfO2lyR7xeX1xZePw1LzSNTjYALmYkXC1Fm6YzRQlEyV1seP5GBJ%2FZMWnYwg%2FEEiEdeaotHlSfSpLW3U8iPe7%2FQu148AKSZyQK%2BBO0dpQHyqsL%2FH79lHSveCH7XnC5e6klChW%2BOqCBofEQaS9wZdr2VZK6AcSAhw8siT%2FxwAUOsjuEyG47aFdL%2FyDjN1mbtYAVyf8Kkx6sylg1nL8N%2Bs36Zi%2B6uIkwa8kXmkeTO4TNaSaBP8VoYc106pOwB2Z4t1SgA6BXhaNpLcTnSbwgkDYThZEmulAwLDm2NdUzEiZuVDD08Oga53LHXeVaSa7Fu6fB%2BYYnJc0Lc17NNVwAsp%2F%2FaFe13QL5%2Fe8rGWum1CgvwjA63R9CLhOWhhCdpncTbzMrhRHnOUBUU%2Biz4CdxLAhMuVldj2KrDT%2BhePDSO8CS9rOhP1%2FNZXq4DR14m8V86VbMBWhN8b2SqKRHy6kL4V5Z%2BFHbAfQpRCCUsO9pJuWUyZ%2Bxj1FDHW96TarsqxLud7caGjZObFU0p4gHYpIOG2PFLcrWEXXaa2o0p8NSeuHqkNiQcLa1D40SGbIv9hZgUimV4ElZ43qogpUCwTp1fG9IiQxJiJhhRwIdWKWEWS47onFJpTwIwQpFL3yIm36m3u%2BgK26AquCVhJz7BcmSQMRa%2BU6VYH1LC2fZVirMwEWKN7p7z3GFaFt0TprheiSLLLZxagEJ1IATa8lKkfsIYBAQHYp45dNqvOUA1mhVMSkbFsomVbSbMrpY%2FDgIw1YCOeII1afZlnjW2v5KXb0pN3zWL5uTg9Oa5tCaBIsemOdcyEnW1OC0ILmuBEHfhVPRu4Vm%2FTuCIDdhBY5ohhehZWoa0vBtQ%2B%2Bdo6bFWUbj1blB8LyF41zlAgHMO7KS1EN2j65rJ53mF0RORBNhXzq5cbWue0fIm%2Ft%2B9";
    var wsURI = 'wss://stream.watsonplatform.net/speech-to-text/api/v1/recognize?watson-token=' +
      token + '&model=es-ES_BroadbandModel';
    var websocket = new WebSocket(wsURI);

    websocket.onopen = function(evt) { onOpen(evt) };
    websocket.onclose = function(evt) { onClose(evt) };
    websocket.onmessage = function(evt) { onMessage(evt) };
    websocket.onerror = function(evt) { onError(evt) };

    function onOpen(evt) {
       var message = {
          'action': 'start',
          'content-type': 'audio/l16;rate=22050'
       };
       console.log("" + message);
       websocket.send(JSON.stringify(message));
    }

    function onClose(evt) {
      websocket.close();
      console.log('websocket closed');
    }

    function onMessage(evt) {
       console.log(evt.data);
    }
  </script>

</head>
<body>
	<ziggeo ziggeo-meta_profile="18fa605e7a98202fb33ab67ffd1e1ea3"></ziggeo>

	<ziggeo ziggeo-meta_profile="_audi"></ziggeo>

	<ziggeo ziggeo-limit=15
	    ziggeo-width=320
	    ziggeo-height=240>
	</ziggeo>
	<!-- Playback -->
	<!-- <ziggeo ziggeo-video=''
    	ziggeo-width=320
    	ziggeo-height=240>
	</ziggeo> -->
</body>

<!-- Alert when video finished recording -->
<script>
ZiggeoApi.Events.on("submitted", function (data) {
    alert("The video with token " + data.video.token + " has been submitted!");
});
</script>

<!-- Play videos code -->
<script>
    ZiggeoApi.Videos.source('')
</script>

<!-- Use Javascript on the client-side to dynamically display videos using e.g. JQuery. -->

<script>
    ZiggeoApi.Videos.index({}, {
        success: function (args, videos) {
            for (var i = 0; i < videos.length; ++i)
                $("body").append("<ziggeo ziggeo-video='" + videos[i].token + "'></ziggeo>");
        }
    });
</script>
</html>